<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>TiGL: The TiGL Viewer Console</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="https://dlr-sc.github.io/tigl/theme/css/font-awesome.min.css" rel="stylesheet"> 
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://dlr-sc.github.io/tigl/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">3.0.0-rc2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tiglviewer_console.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">The TiGL Viewer Console </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>TiGL Viewer comes with a powerful JavaScript console that allows automatizing small workflows or helps debugging of geometries. To show and hide the console, press <b>ALT+C</b>.</p>
<p>The console has two purposes</p>
<ol type="1">
<li>to show all kinds of error messages, warnings etc. from the TiGL and OpenCASCADE engine</li>
<li>to enter user code to steer the TiGL Viewer application</li>
</ol>
<p>In many cases, the user wants to open a CPACS file and execute TiGL function to compute and draw some points on the aircraft surface. Another use case would be to automatize the creation of screenshots of a changing aircraft geometry.</p>
<div class="image">
<img src="tiglviewer_console.png" alt="tiglviewer_console.png"/>
<div class="caption">
The scripting console</div></div>
<p>We copied some practical features from the famous bash terminal to improve the usability of the console. This includes a history of the recently typed commands. Just type</p>
<div class="fragment"><div class="line">history </div>
</div><!-- fragment --><p>To navigate through the recent commands from the history, use the up and down arrow keys.</p>
<p>To clear the console, enter</p>
<div class="fragment"><div class="line">clear </div>
</div><!-- fragment --><p>For a general help, type in</p>
<div class="fragment"><div class="line">help </div>
</div><!-- fragment --><h1><a class="anchor" id="console_basic"></a>
Basic use</h1>
<p>The console understands all kinds of JavaScript elements. Thus, typical constructs like loops, functions, and even classes can be defined. Instead of typing the code into the console, TiGL Viewer can also load and execute a script file. If you want to load a script file during the startup of TiGL Viewer, use the <code>--script</code> option: </p><pre class="fragment"> TIGLViewer --script myscript.js [--filename aircraft.cpacs.xml]
</pre><p><b>The <code>ans</code> object</b>: The result of the last command will be stored in a variable <code>ans</code>. This can be sometimes quite practical:</p>
<div class="fragment"><div class="line">&gt;&gt; 2+3</div>
<div class="line">5</div>
<div class="line">&gt;&gt; ans*ans</div>
<div class="line">25</div>
<div class="line">&gt;&gt; ans - 5</div>
<div class="line">20</div>
</div><!-- fragment --><p>In addition to pure JavaScript, TiGL Viewer offers some function to draw points, vectors and TiGL shapes.</p>
<p><b>Draw a point at (0,0,0)</b></p>
<div class="fragment"><div class="line">drawPoint(<span class="keyword">new</span> Point3d(0,0,0));</div>
</div><!-- fragment --><p><b>Draw an arrow in z direction</b></p>
<div class="fragment"><div class="line">pnt = <span class="keyword">new</span> Point3d(0,0,0);</div>
<div class="line">dir = <span class="keyword">new</span> Point3d(0,0,5);</div>
<div class="line">drawVector(pnt, dir);</div>
</div><!-- fragment --><p><b>Draw the first fuselage of a cpacs file</b></p>
<div class="fragment"><div class="line">uid = tigl.fuselageGetUID(1);</div>
<div class="line">shape = tigl.getShape(uid);</div>
<div class="line">drawShape(shape);</div>
</div><!-- fragment --><p>In case you want to do some vector arithmetic, we defined the <code>Point3d</code> class, which offers some basic vector functionality:</p>
<div class="fragment"><div class="line">&gt;&gt; p = <span class="keyword">new</span> Point3d(10,0,0)</div>
<div class="line">Point3d(10,0,0)</div>
<div class="line">&gt;&gt; p.length()</div>
<div class="line">10</div>
<div class="line">&gt;&gt; p.add(p)</div>
<div class="line">Point3d(20,0,0)</div>
<div class="line">&gt;&gt; p.normalized()</div>
<div class="line">Point3d(1,0,0)</div>
<div class="line">&gt;&gt; p.dot(p)</div>
<div class="line">100</div>
<div class="line">&gt;&gt; p.mult(0.5)</div>
<div class="line">Point3d(5,0,0)</div>
<div class="line">&gt;&gt; q = new Point3d(0,10,0)</div>
<div class="line">Point3d(0,10,0)</div>
<div class="line">&gt;&gt; p.cross(q)</div>
<div class="line">Point3d(0,0,100)</div>
</div><!-- fragment --><p>To get a list of all <code>Point3d</code> methods, enter</p>
<div class="fragment"><div class="line">help(<span class="keyword">new</span> Point3d);</div>
</div><!-- fragment --><h1><a class="anchor" id="console_mainobj"></a>
The main application objects</h1>
<p>The TiGL Viewer scripting engine consists of four main objects. The whole application can be controlled with only these four objects. These are app, app.viewer, app.scene, and tigl.</p>
<p>The scripting engine contains a <em>help()</em> function that shows the available methods and properties for each object. To show the help for e.g. the tigl object, enter</p>
<div class="fragment"><div class="line">help(tigl);</div>
</div><!-- fragment --><h2><a class="anchor" id="app"></a>
The app object</h2>
<p>This is the main object of the application. It is used to load and save files, load scripts, control the application's window size, and also close the application. Some methods of the app object are</p>
<table class="doxtable">
<tr>
<th>method </th><th>description  </th></tr>
<tr>
<td>openFile </td><td>opens a file (CPACS, STEP, IGES, BREP) </td></tr>
<tr>
<td>saveFile </td><td>saves all visible objects to a file (STEP, IGES, BREP, STL) </td></tr>
<tr>
<td>openScript </td><td>executes a TiGL Viewer script file </td></tr>
<tr>
<td>closeConfiguration </td><td>closes the current CPACS configuration and clears the scene </td></tr>
<tr>
<td>close </td><td>terminates TiGL Viewer </td></tr>
</table>
<p>To get a list of all methods and properties, enter help(app) in the TiGL Viewer console.</p>
<h2><a class="anchor" id="appviewer"></a>
The app.viewer object</h2>
<p>This object controls the rendering of the 3D view. It can be used to</p>
<ul>
<li>change the camera position,</li>
<li>make screen shots,</li>
<li>set the background color or a background image,</li>
<li>and fit all objects into the view.</li>
</ul>
<p>There are different options, to make a screen shot of the viewer. The simplest is</p>
<div class="fragment"><div class="line">app.viewer.makeScreenshot(<span class="stringliteral">&quot;myfile-white.jpg&quot;</span>);</div>
</div><!-- fragment --><p>This will create a screenshot with a white background color and the size of the image will be the size of the viewer's window. To disable the white background, type</p>
<div class="fragment"><div class="line">app.viewer.makeScreenshot(<span class="stringliteral">&quot;myfile.jpg&quot;</span>, <span class="keyword">false</span>);</div>
</div><!-- fragment --><p>In addition, you can also control the size of the resulting image file. However, <b>this feature does not work in Linux or Max OS X</b>. The syntax is the following:</p>
<div class="fragment"><div class="line">app.viewer.makeScreenshot(<span class="stringliteral">&quot;myfile-large.jpg&quot;</span>, <span class="keyword">true</span>, 1500, 1000);</div>
</div><!-- fragment --><p>The most important methods of the <em>app.viewer</em> object are:</p>
<table class="doxtable">
<tr>
<th>method </th><th>description  </th></tr>
<tr>
<td>setBackgroundColor </td><td>sets a solid background color (RGB triple, 0..255) </td></tr>
<tr>
<td>setBackgroundGradient </td><td>sets a background with gradually darkening color(RGB triple, 0..255) </td></tr>
<tr>
<td>viewTop </td><td>moves camera to the top view </td></tr>
<tr>
<td>viewFront </td><td>moves camera to the front view </td></tr>
<tr>
<td>viewLeft </td><td>moves camera to the left view </td></tr>
<tr>
<td>viewAxo </td><td>changes camera to axonometrix view (top, left, front) </td></tr>
<tr>
<td>fitAll </td><td>fits all objects into the viewer window </td></tr>
<tr>
<td>zoomIn </td><td>zooms in the camera </td></tr>
<tr>
<td>zoomOut </td><td>zooms out the camera </td></tr>
</table>
<p>To get a list of all methods and properties, enter</p>
<div class="fragment"><div class="line">help(app.viewer);</div>
</div><!-- fragment --><p>in the TiGL Viewer console.</p>
<h2><a class="anchor" id="appscene"></a>
The app.scene object</h2>
<p>The application scene controls, which objects are shown in the 3D view. Thus, it offers methods to display objects and points, to clear the whole scene and modifying the grid display.</p>
<p>The most important <em>app.scene</em> methods are:</p>
<table class="doxtable">
<tr>
<th>method </th><th>description  </th></tr>
<tr>
<td>wireFrame </td><td>if argument is true, all objetcs will be displayed in wireframe mode </td></tr>
<tr>
<td>displayShape </td><td>displays a TiGL geometry (e.g. got from tigl.getShape("wingUID")) </td></tr>
<tr>
<td>drawPoint </td><td>draws a point (e.g. app.scene.drawPoint(0,0,10)) </td></tr>
<tr>
<td>drawVector </td><td>draws a vector/arrow (e.g. app.scene.drawVector(x,y,z,dx,dy,dz)) </td></tr>
<tr>
<td>deleteAllObjects </td><td>clears the scene </td></tr>
<tr>
<td>gridOn </td><td>displays the grid </td></tr>
<tr>
<td>gridOff </td><td>turns of the grid display </td></tr>
<tr>
<td>gridXY </td><td>Sets the grid into the X-Y plane </td></tr>
<tr>
<td>gridXZ </td><td>Sets the grid into the X-Z plane </td></tr>
<tr>
<td>gridYZ </td><td>Sets the grid into the Y-Z plane </td></tr>
<tr>
<td>gridCirc </td><td>Switches the grid into polar form </td></tr>
<tr>
<td>gridRect </td><td>Swictehs the grid into cartesian form </td></tr>
</table>
<p>To get a list of all app.scene methods and properties, enter:</p>
<div class="fragment"><div class="line">help(app.scene);</div>
</div><!-- fragment --><h2><a class="anchor" id="console_tigl"></a>
The tigl object</h2>
<p>The tigl object is used to access the TiGL library functions. Currently, not all functions are wrapped.</p>
<p>These are the functions currently wrapped by the scripting interface</p>
<ul>
<li>getWingCount()</li>
<li>getVersion()</li>
<li>componentGetHashCode(componentUID)</li>
<li>componentIntersectionLineCount(componentUidOne, componentUidTwo)</li>
<li>exportFusedWingFuselageIGES(filename)</li>
<li>exportIGES(filename)</li>
<li>exportSTEP(filename)</li>
<li>exportMeshedFuselageSTL(fuselageIndex, filename, deflection)</li>
<li>exportMeshedFuselageVTKByIndex(fuselageIndex, filename, deflection)</li>
<li>exportMeshedFuselageVTKByUID(fuselageUID, filename, deflection)</li>
<li>fuselageGetUID(fuselageIndex)</li>
<li>fuselageGetCircumference(fuselageIndex, segmentIndex, eta)</li>
<li>fuselageGetPoint(fuselageIndex, segmentIndex, eta, zeta)</li>
<li>fuselageGetSegmentUID(fuselageIndex, segmentIndex)</li>
<li>fuselageGetSegmentVolume(fuselageIndex, segmentIndex)</li>
<li>getFuselageCount()</li>
<li>fuselageGetSegmentCount(fuselageIndex)</li>
<li>wingGetUpperPoint(wingIndex, segmentIndex, eta, xsi)</li>
<li>wingGetUID(wingIndex)</li>
<li>wingGetLowerPoint(wingIndex, segmentIndex, eta, xsi)</li>
<li>wingGetUpperPointAtDirection(wingIndex, segmentIndex, eta, xsi, dirx, diry, dirz)</li>
<li>wingGetLowerPointAtDirection(wingIndex, segmentIndex, eta, xsi, dirx, diry, dirz)</li>
<li>wingGetChordPoint(wingIndex, segmentIndex, eta, xsi)</li>
<li>wingGetChordNormal(wingIndex, segmentIndex, eta, xsi)</li>
<li>wingGetSegmentCount(wingIndex)</li>
<li>wingGetSegmentUID(wingIndex, segmentIndex)</li>
<li>getErrorString(errorCode)</li>
<li>getShape(uid)</li>
</ul>
<p>In comparison to the C/C++ API, the scripting functions don't return error codes. Instead, an exception is thrown in case of an error, e.g. if no CPACS file is currently open.</p>
<p>The use of these functions is analog to the TiGL functions of the C API. The only exception is the <code>tigl.getShape(uid)</code> method. It can be used to return the CAD representation of a CPACS entity. Currently, only wings, fuselages, wing segments, and fuselage segments can be returned by <code>getShape</code>. The returned shape can then be rendered using the <code>drawShape</code> command.</p>
<p>The point sampling functions (e.g. <code>fuselageGetPoint</code>, <code>wingGetChordPoint</code>, ...) return a Point3d object.</p>
<p><b>Example</b></p>
<div class="fragment"><div class="line">app.openFile(<span class="stringliteral">&quot;aircraft.cpacs.xml&quot;</span>);</div>
<div class="line">p = tigl.wingGetUpperPoint(1, 1, 0.5, 0.2);</div>
<div class="line">drawPoint(p);</div>
</div><!-- fragment --><h1><a class="anchor" id="examples"></a>
Examples</h1>
<p>Here are some real life examples how to use the scripting engine:</p>
<p><em>Open a file</em> </p><div class="fragment"><div class="line">app.openFile(<span class="stringliteral">&quot;airplane.cpacs.xml&quot;</span>);</div>
</div><!-- fragment --><p><em>Change to top view and save screenshot to image.png</em> </p><div class="fragment"><div class="line">app.viewer.viewTop();</div>
<div class="line">app.viewer.fitAll();</div>
<div class="line">app.viewer.zoomOut();</div>
<div class="line">app.viewer.makeScreenshot(<span class="stringliteral">&quot;image.png&quot;</span>);</div>
</div><!-- fragment --><p><em>Convert a <b>STEP</b> file into <b>IGES</b> format and close TiGL Viewer</em> </p><div class="fragment"><div class="line">app.openFile(<span class="stringliteral">&quot;part.stp&quot;</span>);</div>
<div class="line">app.saveFile(<span class="stringliteral">&quot;part.igs&quot;</span>);</div>
<div class="line">app.close();</div>
</div><!-- fragment --><p><em>Display all wings of an aircraft (which is already opened)</em></p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (iwing = 1; iwing &lt;= tigl.getWingCount(); ++iwing) {</div>
<div class="line">  uid = tigl.wingGetUID(iwing);</div>
<div class="line">  shape = tigl.getShape(uid);</div>
<div class="line">  drawShape(shape);</div>
<div class="line">}</div>
</div><!-- fragment --><p><em>Switch to fullscreen view</em> </p><div class="fragment"><div class="line">app.showFullScreen();</div>
</div><!-- fragment --><p><em>Delete all visible objects</em> </p><div class="fragment"><div class="line">app.scene.deleteAllObjects();</div>
</div><!-- fragment --><p><em>Disable the coordinate grid</em> </p><div class="fragment"><div class="line">app.scene.gridOff();</div>
</div><!-- fragment --><p><em>Show polar grid in y-z plane</em> </p><div class="fragment"><div class="line">app.scene.gridCirc();</div>
<div class="line">app.scene.gridYZ();</div>
<div class="line">app.scene.gridOn();</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<div id="nav-path" class="footer-area ">
	<footer class="section-padding">
		<div class="social-btn footer-social text-center">
			<!--<a href="https://twitter.com" class="twitter"><i class="fa fa-twitter"></i></a>-->
			<!--<a href="https://www.youtube.com" class="youtube"><i class="fa fa-youtube"></i></a>-->
			<a href="https://github.com/DLR-SC/tigl" class="github"><i class="fa fa-github"></i></a>
		</div>
		<div class="site-info text-center">
			 © 2019 <a href="http://www.DLR.de">Deutsches Zentrum für Luft- und Raumfahrt e.V.</a>
                	&nbsp;·&nbsp;<a href="http://www.dlr.de/sc">Simulation and Software Technology</a>
                	&nbsp;·&nbsp;<a href="https://dlr-sc.github.io/tigl/pages/imprint.html">Imprint</a>
                	&nbsp;·&nbsp;<a href="https://dlr-sc.github.io/tigl/pages/privacy.html">Privacy</a>
		</div>
	</footer>
</div>
</body>
</html>
